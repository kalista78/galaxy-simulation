<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Milky Way Galaxy Simulation</title>
    <link rel="stylesheet" href="styles.css?v=4">
    <link rel="stylesheet" href="nav.css?v=1">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="loading-content">
            <div class="loading-galaxy">
                <div class="loading-ring"></div>
                <div class="loading-ring delay-1"></div>
                <div class="loading-ring delay-2"></div>
                <div class="loading-core"></div>
            </div>
            <div class="loading-title">MILKY WAY</div>
            <div class="loading-subtitle">Initializing 310,000 stars...</div>
            <div class="loading-bar-container">
                <div class="loading-bar-fill"></div>
            </div>
        </div>
    </div>

    <div id="info">Milky Way Galaxy Â· ~300,000 stars Â· Scroll to zoom Â· Drag to rotate</div>

    <!-- Control Panel -->
    <div id="controls">
        <h2 id="controls-header">Galaxy Controls</h2>

        <div class="controls-content">
            <div class="control-group">
                <label>Rotation Speed <span class="value" id="speed-val">1.0x</span></label>
                <input type="range" id="speed" min="0" max="5" step="0.1" value="1">
            </div>

            <div class="control-group">
                <label>Star Brightness <span class="value" id="brightness-val">100%</span></label>
                <input type="range" id="brightness" min="0.2" max="2" step="0.1" value="1">
            </div>

            <div class="control-group">
                <label>Bloom Intensity <span class="value" id="bloom-val">0.8</span></label>
                <input type="range" id="bloom" min="0" max="2" step="0.1" value="0.8">
            </div>

            <div class="control-group">
                <label>Core Glow <span class="value" id="core-val">100%</span></label>
                <input type="range" id="core" min="0" max="2" step="0.1" value="1">
            </div>

            <div class="control-group">
                <label>Time Scale <span class="value" id="time-val">1.0x</span></label>
                <input type="range" id="timescale" min="0.1" max="10" step="0.1" value="1">
            </div>

            <div class="control-row">
                <button class="btn active" id="btn-play">Play</button>
                <button class="btn" id="btn-pause">Pause</button>
            </div>

            <div class="control-row">
                <button class="btn" id="btn-autorotate">Auto Rotate</button>
                <button class="btn" id="btn-reset">Reset View</button>
            </div>

            <div class="control-row">
                <button class="btn" id="btn-top">Top View</button>
                <button class="btn" id="btn-side">Side View</button>
            </div>

            <div class="control-row">
                <button class="btn" id="btn-tour" style="background: linear-gradient(135deg, rgba(100,255,200,0.2), rgba(100,150,255,0.1)); border-color: rgba(100,255,200,0.4);">
                    âœ¨ Cinematic Tour
                </button>
            </div>

            <div class="control-row">
                <button class="btn" id="btn-solar" style="background: linear-gradient(135deg, rgba(255,200,100,0.2), rgba(100,150,255,0.1)); border-color: rgba(255,200,100,0.4);">
                    â˜€ Solar System
                </button>
            </div>

            <div class="control-row">
                <button class="btn" id="btn-blackhole" style="background: linear-gradient(135deg, rgba(50,0,80,0.3), rgba(255,100,50,0.1)); border-color: rgba(200,100,255,0.4);">
                    âš« Black Hole
                </button>
            </div>

            <div class="control-row">
                <button class="btn" id="btn-merger" style="background: linear-gradient(135deg, rgba(100,50,150,0.3), rgba(50,100,200,0.2)); border-color: rgba(150,100,255,0.5);">
                    ğŸ’« Andromeda Collision
                </button>
            </div>

            <div class="control-row">
                <button class="btn" id="btn-supernova" style="background: linear-gradient(135deg, rgba(255,100,50,0.3), rgba(255,200,100,0.2)); border-color: rgba(255,150,100,0.5);">
                    ğŸ’¥ Supernova
                </button>
            </div>

            <div class="control-row">
                <a href="universe_scale.html" class="btn" id="btn-universe" style="background: linear-gradient(135deg, rgba(100,255,200,0.2), rgba(150,100,255,0.2)); border-color: rgba(100,255,200,0.5); text-decoration: none; display: flex; align-items: center; justify-content: center;">
                    ğŸ”¬ Universe Scale
                </a>
            </div>

            <div class="control-section-label">Explore More</div>

            <div class="control-row">
                <a href="nebula.html" class="btn" style="background: linear-gradient(135deg, rgba(200,50,100,0.2), rgba(100,50,200,0.2)); border-color: rgba(200,100,200,0.5); text-decoration: none; display: flex; align-items: center; justify-content: center;">
                    ğŸŒˆ Nebula Explorer
                </a>
            </div>

            <div class="control-row">
                <a href="evolution.html" class="btn" style="background: linear-gradient(135deg, rgba(255,150,50,0.3), rgba(255,50,50,0.2)); border-color: rgba(255,150,100,0.5); text-decoration: none; display: flex; align-items: center; justify-content: center;">
                    ğŸ”¥ Cosmic Evolution
                </a>
            </div>

            <div class="control-row">
                <a href="gravity.html" class="btn" style="background: linear-gradient(135deg, rgba(50,200,255,0.2), rgba(50,100,255,0.2)); border-color: rgba(100,200,255,0.5); text-decoration: none; display: flex; align-items: center; justify-content: center;">
                    âš›ï¸ Gravity Lab
                </a>
            </div>

            <div class="sound-controls">
                <div class="control-row">
                    <button class="btn" id="btn-sound" style="background: linear-gradient(135deg, rgba(100,200,255,0.2), rgba(150,100,255,0.1)); border-color: rgba(100,200,255,0.4);">
                        ğŸ”Š Enable Sound
                    </button>
                </div>
                <div class="control-group sound-volume" style="display: none;">
                    <label>Volume <span class="value" id="volume-val">70%</span></label>
                    <input type="range" id="volume" min="0" max="100" step="5" value="70">
                </div>
            </div>

            <div class="stats">
                <div>Total Stars: <span class="val">~310,000</span></div>
                <div>Disk Stars: <span class="val">220,000</span></div>
                <div>Bulge Stars: <span class="val">50,000</span></div>
                <div>Halo/GC Stars: <span class="val">15,000</span></div>
                <div>Deep Field: <span class="val">200 galaxies</span></div>
                <div>FPS: <span class="val" id="fps-val">--</span></div>
                <div>Rotation: <span class="val" id="rotation-val">0Â°</span></div>
            </div>
        </div>

        <div class="compact-buttons">
            <button class="btn" id="btn-tour-compact" title="Cinematic Tour">âœ¨</button>
            <button class="btn" id="btn-solar-compact" title="Solar System">â˜€</button>
            <button class="btn" id="btn-blackhole-compact" title="Black Hole">âš«</button>
            <button class="btn" id="btn-merger-compact" title="Andromeda Collision">ğŸ’«</button>
            <button class="btn" id="btn-supernova-compact" title="Supernova">ğŸ’¥</button>
            <a href="universe_scale.html" class="btn" id="btn-universe-compact" title="Universe Scale" style="text-decoration: none;">ğŸ”¬</a>
            <a href="nebula.html" class="btn" title="Nebula Explorer" style="text-decoration: none;">ğŸŒˆ</a>
            <a href="evolution.html" class="btn" title="Cosmic Evolution" style="text-decoration: none;">ğŸ”¥</a>
            <a href="gravity.html" class="btn" title="Gravity Lab" style="text-decoration: none;">âš›ï¸</a>
            <button class="btn" id="btn-sound-compact" title="Toggle Sound">ğŸ”Š</button>
        </div>
    </div>
    <button id="toggle-panel">Show Controls</button>

    <!-- Cinematic Letterbox Bars -->
    <div id="letterbox-top" class="letterbox-bar"></div>
    <div id="letterbox-bottom" class="letterbox-bar"></div>

    <!-- Cinematic Fade Overlay -->
    <div id="cinematic-fade"></div>

    <!-- Tour Progress Bar -->
    <div id="tour-progress">
        <div id="tour-progress-fill"></div>
    </div>

    <!-- Tour Subtitle -->
    <div id="tour-subtitle"></div>

    <!-- Journey Overlay -->
    <div id="journey-overlay">
        <div class="journey-text" id="journey-title">Traveling to the Solar System</div>
        <div class="journey-subtitle" id="journey-sub">Orion Arm Â· 26,000 light-years from center</div>
        <div class="journey-distance" id="journey-dist"></div>
    </div>

    <!-- Return Button -->
    <button id="btn-return">â†© Return to Galaxy View</button>

    <!-- Planet Info Overlay -->
    <div id="planet-overlay">
        <div class="planet-info">
            <h3 id="planet-name">Earth</h3>
            <div class="planet-details">
                <div class="planet-stat">
                    <span class="stat-label">Distance from Sun</span>
                    <span class="stat-value" id="planet-distance">149.6 million km</span>
                </div>
                <div class="planet-stat">
                    <span class="stat-label">Diameter</span>
                    <span class="stat-value" id="planet-diameter">12,742 km</span>
                </div>
                <div class="planet-stat">
                    <span class="stat-label">Day Length</span>
                    <span class="stat-value" id="planet-day">24 hours</span>
                </div>
                <div class="planet-stat">
                    <span class="stat-label">Year Length</span>
                    <span class="stat-value" id="planet-year">365.25 days</span>
                </div>
            </div>
        </div>
        <button id="btn-exit-planet">â†© Return to Solar System</button>
    </div>

    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
        }
    }
    </script>

    <script type="module">
        import { MilkyWaySimulation } from './js/MilkyWaySimulation.js?v=14';

        // Hide loading screen once simulation is ready
        const loadingScreen = document.getElementById('loading-screen');
        const loadingFill = document.querySelector('.loading-bar-fill');

        // Animate loading bar
        let progress = 0;
        const loadingInterval = setInterval(() => {
            progress += Math.random() * 15;
            if (progress > 90) progress = 90;
            loadingFill.style.width = progress + '%';
        }, 200);

        // Initialize simulation
        const sim = new MilkyWaySimulation();

        // Complete loading
        clearInterval(loadingInterval);
        loadingFill.style.width = '100%';
        setTimeout(() => {
            loadingScreen.classList.add('fade-out');
            setTimeout(() => loadingScreen.remove(), 800);
        }, 500);
    </script>

    <script type="module">
        import { initNavigation } from './js/nav.js?v=1';
        initNavigation({ activePage: 'milkyway' });
    </script>
</body>
</html>
